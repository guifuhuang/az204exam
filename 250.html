<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Web App 测试题</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .question {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .options {
            margin-left: 20px;
        }
        .option {
            margin-bottom: 10px;
        }
        .answer {
            display: none;
            background-color: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        button {
            background-color: #0078d4;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #106ebe;
        }
    </style>
</head>
<body>
    <div class="question">
        <h2>QUESTION NO: 250</h2>
        <p>You are developing a web application that runs as an Azure Web App. The web application stores data in Azure SQL Database and stores files in an Azure Storage account. The web application makes HTTP requests to external services as part of normal operations.</p>
        <p>The web application is instrumented with Application Insights. The external services are OpenTelemetry compliant.</p>
        <p>You need to ensure that the customer ID of the signed in user is associated with all operations throughout the overall system.</p>
        <p>What should you do?</p>
        
        <div class="options">
            <div class="option">
                <input type="radio" name="answer" id="optionA" value="A">
                <label for="optionA">A. Create a new SpanContext with the TraceRags value set to the customer ID for the signed in user.</label>
            </div>
            <div class="option">
                <input type="radio" name="answer" id="optionB" value="B">
                <label for="optionB">B. On the current SpanContext, set the Traceld to the customer ID for the signed in user.</label>
            </div>
            <div class="option">
                <input type="radio" name="answer" id="optionC" value="C">
                <label for="optionC">C. Add the customer ID for the signed in user to the CorrelationContext in the web application.</label>
            </div>
            <div class="option">
                <input type="radio" name="answer" id="optionD" value="D">
                <label for="optionD">D. Set the header Ocp-Apim-Trace to the customer ID for the signed in user.</label>
            </div>
        </div>
    </div>
    
    <button onclick="showAnswer()">查看答案</button>
    
    <div id="answer" class="answer">
        <h3>正确答案: C</h3>
        <p>解释说明:</p>
        <p>在分布式跟踪系统中，CorrelationContext是用于在系统中传递上下文信息（如用户ID）的正确方式。OpenTelemetry和Application Insights都支持使用CorrelationContext来关联跨服务的操作。</p>
        <p>选项A和B错误地建议修改SpanContext或TraceId，这些是用于跟踪的技术标识符，不应该包含业务数据如客户ID。</p>
        <p>选项D提到的Ocp-Apim-Trace头是Azure API Management特定的调试头，不适合用于传递业务上下文。</p>
        <p>最佳实践是将客户ID添加到CorrelationContext中，这样它就能自动传播到所有下游服务和跟踪中，同时保持跟踪系统的技术标识符不变。</p>
    </div>
    
    <script>
        function showAnswer() {
            document.getElementById('answer').style.display = 'block';
        }
    </script>
</body>
</html>

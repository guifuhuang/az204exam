<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Key Vault Access</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            color: #0078d4;
            text-align: center;
        }
        .question-container {
            background-color: #f3f2f1;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .drag-drop-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .drag-source {
            flex: 1;
            background-color: #f3f2f1;
            padding: 15px;
            border-radius: 5px;
            min-height: 200px;
        }
        .drop-target {
            flex: 2;
            background-color: #e5f5ff;
            padding: 15px;
            border-radius: 5px;
            min-height: 200px;
        }
        .drag-item {
            background-color: white;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            cursor: move;
        }
        .drag-item:hover {
            background-color: #f0f0f0;
        }
        .code-block {
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 5px;
            font-family: Consolas, 'Courier New', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .code-segment {
            background-color: #3a3a3a;
            color: #ffcc00;
            padding: 2px 5px;
            border-radius: 3px;
            margin: 5px 0;
            display: inline-block;
        }
        .button-container {
            text-align: center;
            margin-top: 20px;
        }
        button {
            background-color: #0078d4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #005a9e;
        }
        .answer-section {
            display: none;
            margin-top: 30px;
            background-color: #f3f2f1;
            padding: 20px;
            border-radius: 5px;
        }
        .answer-section h3 {
            color: #0078d4;
            margin-top: 0;
        }
        .correct-answer {
            background-color: #dff6dd;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        .explanation {
            background-color: white;
            padding: 15px;
            border-radius: 4px;
        }
        @media (max-width: 768px) {
            .drag-drop-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <h1>QUESTION NO: 264 DRAG DROP</h1>
    
    <div class="question-container">
        <p>You are developing an Azure solution.</p>
        <p>You need to develop code to access a secret stored in Azure Key Vault.</p>
        <p>How should you complete the code segment? To answer, drag the appropriate code segments to the correct locations. Each code segment may be used once, more than once, or not at all.</p>
        <p><strong>NOTE:</strong> Each correct selection is worth one point.</p>
    </div>
    
    <div class="drag-drop-container">
        <div class="drag-source" id="source">
            <div class="drag-item" draggable="true" data-id="DefaultAzureCredential">DefaultAzureCredential</div>
            <div class="drag-item" draggable="true" data-id="ClientSecretCredential">ClientSecretCredential</div>
            <div class="drag-item" draggable="true" data-id="CloudClients">CloudClients</div>
            <div class="drag-item" draggable="true" data-id="SecretClient">SecretClient</div>
        </div>
        <div class="drop-target" id="target">
            <div class="code-block">
string var1 = Environment.GetEnvironmentVariable("KEY_VAULT_URI");
var var2 = new <span class="code-segment" id="drop-segment1">Code segment</span>(new Uri(var1), new <span class="code-segment" id="drop-segment2">Code segment</span>());
            </div>
        </div>
    </div>
    
    <div class="button-container">
        <button id="check-answer">Check Answer</button>
    </div>
    
    <div id="answer-section" class="answer-section">
        <h3>Correct Answer and Explanation</h3>
        <div class="correct-answer">
            <p><strong>Correct Selections:</strong></p>
            <ul>
                <li>First segment: SecretClient</li>
                <li>Second segment: DefaultAzureCredential</li>
            </ul>
        </div>
        <div class="explanation">
            <p><strong>中文说明：</strong></p>
            <p>1. <strong>第一个代码段: SecretClient</strong></p>
            <ul>
                <li>用于与Azure Key Vault交互的主客户端类</li>
                <li>提供获取、设置和管理机密的方法</li>
                <li>需要Key Vault URI和凭据进行初始化</li>
            </ul>
            
            <p>2. <strong>第二个代码段: DefaultAzureCredential</strong></p>
            <ul>
                <li>来自Azure Identity库的默认认证类</li>
                <li>自动尝试多种认证方式(开发环境更简便)</li>
                <li>支持在不同环境中使用相同的代码</li>
                <li>会按顺序尝试以下认证方式:
                    <ol>
                        <li>环境变量</li>
                        <li>托管身份</li>
                        <li>Visual Studio登录</li>
                        <li>Azure CLI登录</li>
                    </ol>
                </li>
            </ul>
            
            <p><strong>技术说明：</strong></p>
            <ul>
                <li>代码流程:
                    <ol>
                        <li>从环境变量获取Key Vault URI</li>
                        <li>创建DefaultAzureCredential用于认证</li>
                        <li>初始化SecretClient与Key Vault交互</li>
                    </ol>
                </li>
                <li>最佳实践:
                    <ul>
                        <li>DefaultAzureCredential是推荐的生产环境认证方式</li>
                        <li>本地开发时可使用Visual Studio或Azure CLI登录</li>
                        <li>生产环境使用托管身份(MI)</li>
                        <li>永远不要将密钥硬编码在代码中</li>
                    </ul>
                </li>
                <li>替代方案比较:
                    <table border="1">
                        <tr>
                            <th>认证方式</th>
                            <th>适用场景</th>
                            <th>安全性</th>
                        </tr>
                        <tr>
                            <td>DefaultAzureCredential</td>
                            <td>通用(开发+生产)</td>
                            <td>高(自动选择最安全方式)</td>
                        </tr>
                        <tr>
                            <td>ClientSecretCredential</td>
                            <td>服务到服务</td>
                            <td>中(需要保护客户端密钥)</td>
                        </tr>
                    </table>
                </li>
            </ul>
            
            <p><strong>参考文档：</strong> 
            <a href="https://docs.microsoft.com/en-us/dotnet/api/azure.security.keyvault.secrets.secretclient" target="_blank">SecretClient 文档</a> | 
            <a href="https://docs.microsoft.com/en-us/dotnet/api/azure.identity.defaultazurecredential" target="_blank">DefaultAzureCredential 文档</a></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const source = document.getElementById('source');
            const target = document.getElementById('target');
            const dropSegment1 = document.getElementById('drop-segment1');
            const dropSegment2 = document.getElementById('drop-segment2');
            const checkAnswerBtn = document.getElementById('check-answer');
            const answerSection = document.getElementById('answer-section');
            
            let draggedItem = null;
            
            // Drag start event
            source.addEventListener('dragstart', function(e) {
                if (e.target.classList.contains('drag-item')) {
                    draggedItem = e.target;
                    e.dataTransfer.setData('text/plain', e.target.dataset.id);
                    setTimeout(() => {
                        e.target.style.opacity = '0.4';
                    }, 0);
                }
            });
            
            // Drag end event
            source.addEventListener('dragend', function(e) {
                if (e.target.classList.contains('drag-item')) {
                    setTimeout(() => {
                        e.target.style.opacity = '1';
                        draggedItem = null;
                    }, 0);
                }
            });
            
            // Drag over event for drop targets
            [dropSegment1, dropSegment2].forEach(dropTarget => {
                dropTarget.addEventListener('dragover', function(e) {
                    e.preventDefault();
                });
                
                dropTarget.addEventListener('drop', function(e) {
                    e.preventDefault();
                    if (draggedItem) {
                        this.textContent = draggedItem.textContent;
                        this.style.backgroundColor = '#4CAF50';
                        this.style.color = 'white';
                        this.dataset.selectedCode = draggedItem.dataset.id;
                    }
                });
            });
            
            // Check answer button
            checkAnswerBtn.addEventListener('click', function() {
                // Check answers
                const segment1Answer = dropSegment1.dataset.selectedCode;
                const segment2Answer = dropSegment2.dataset.selectedCode;
                
                if (segment1Answer === 'SecretClient') {
                    dropSegment1.style.backgroundColor = '#4CAF50';
                } else {
                    dropSegment1.style.backgroundColor = '#FF5722';
                }
                
                if (segment2Answer === 'DefaultAzureCredential') {
                    dropSegment2.style.backgroundColor = '#4CAF50';
                } else {
                    dropSegment2.style.backgroundColor = '#FF5722';
                }
                
                answerSection.style.display = 'block';
                window.scrollTo({
                    top: answerSection.offsetTop,
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html>

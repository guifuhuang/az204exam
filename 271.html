<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Notification Hubs - WNS Raw Notifications</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            color: #0078d4;
            text-align: center;
        }
        .question-container {
            background-color: #f3f2f1;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .drag-drop-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .drag-source {
            flex: 1;
            background-color: #f3f2f1;
            padding: 15px;
            border-radius: 5px;
            min-height: 300px;
        }
        .drop-target {
            flex: 2;
            background-color: #e5f5ff;
            padding: 15px;
            border-radius: 5px;
            min-height: 300px;
        }
        .drag-item {
            background-color: white;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            cursor: move;
        }
        .drag-item:hover {
            background-color: #f0f0f0;
        }
        .code-block {
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 5px;
            font-family: Consolas, 'Courier New', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .code-segment {
            background-color: #3a3a3a;
            color: #ffcc00;
            padding: 2px 5px;
            border-radius: 3px;
            margin: 5px 0;
            display: inline-block;
        }
        .button-container {
            text-align: center;
            margin-top: 20px;
        }
        button {
            background-color: #0078d4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #005a9e;
        }
        .answer-section {
            display: none;
            margin-top: 30px;
            background-color: #f3f2f1;
            padding: 20px;
            border-radius: 5px;
        }
        .answer-section h3 {
            color: #0078d4;
            margin-top: 0;
        }
        .correct-answer {
            background-color: #dff6dd;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        .explanation {
            background-color: white;
            padding: 15px;
            border-radius: 4px;
        }
        @media (max-width: 768px) {
            .drag-drop-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <h1>QUESTION NO: 271 DRAG DROP</h1>
    
    <div class="question-container">
        <p>You are a developer for a Software as a Service (SaaS) company. You develop solutions that provide the ability to send notifications by using Azure Notification Hubs.</p>
        <p>You need to create sample code that customers can use as a reference for how to send raw notifications to Windows Push Notification Services (WNS) devices. The sample code must not use external packages.</p>
        <p>How should you complete the code segment? To answer, drag the appropriate code segments to the correct locations. Each code segment may be used once, more than once, or not at all.</p>
        <p><strong>NOTE:</strong> Each correct selection is worth one point.</p>
    </div>
    
    <div class="drag-drop-container">
        <div class="drag-source" id="source">
            <div class="drag-item" draggable="true" data-id="raw">raw</div>
            <div class="drag-item" draggable="true" data-id="windows">windows</div>
            <div class="drag-item" draggable="true" data-id="windowsphone">windowsphone</div>
            <div class="drag-item" draggable="true" data-id="application/xhtml+xml">application/xhtml+xml</div>
            <div class="drag-item" draggable="true" data-id="application/xml">application/xml</div>
            <div class="drag-item" draggable="true" data-id="application/octet-stream">application/octet-stream</div>
        </div>
        <div class="drop-target" id="target">
            <div class="code-block">
var endpoint = "{serviceBusNamespace}.servicebus.windows.net/{notificationHubName}/messages";
var payload = "{...}";
var request = new HttpRequestMessage(HttpMethod.Post, endpoint);
request.Headers.Add("ServiceBusNotification-Format", "<span class="code-segment" id="drop-segment1">Code segment</span>");
request.Content = new StringContent(payload, Encoding.UTF8, "<span class="code-segment" id="drop-segment2">Code segment</span>");
var client = new HttpClient();
client.SendAsync(request);
            </div>
        </div>
    </div>
    
    <div class="button-container">
        <button id="check-answer">Check Answer</button>
    </div>
    
    <div id="answer-section" class="answer-section">
        <h3>Correct Answer and Explanation</h3>
        <div class="correct-answer">
            <p><strong>Correct Selections:</strong></p>
            <ul>
                <li>First segment: windows</li>
                <li>Second segment: application/octet-stream</li>
            </ul>
        </div>
        <div class="explanation">
            <p><strong>中文说明：</strong></p>
            <p>1. <strong>第一个代码段: windows</strong></p>
            <ul>
                <li>指定通知格式为Windows推送通知服务(WNS)</li>
                <li>替换示例代码中的"gcm"(Google Cloud Messaging)</li>
                <li>告知Azure Notification Hubs将通知发送到WNS设备</li>
            </ul>
            
            <p>2. <strong>第二个代码段: application/octet-stream</strong></p>
            <ul>
                <li>设置内容类型为二进制流</li>
                <li>适用于发送原始通知(raw notifications)</li>
                <li>WNS原始通知不需要特定格式，直接传递二进制数据</li>
            </ul>
            
            <p><strong>技术说明：</strong></p>
            <ul>
                <li>代码流程:
                    <ol>
                        <li>构建通知终结点URL</li>
                        <li>准备通知负载(payload)</li>
                        <li>创建HTTP POST请求</li>
                        <li>设置通知格式头为"windows"</li>
                        <li>设置内容类型为"application/octet-stream"</li>
                        <li>发送请求到Azure Notification Hubs</li>
                    </ol>
                </li>
                <li>关键参数:
                    <table border="1">
                        <tr>
                            <th>参数</th>
                            <th>值</th>
                            <th>说明</th>
                        </tr>
                        <tr>
                            <td>ServiceBusNotification-Format</td>
                            <td>windows</td>
                            <td>指定目标平台为WNS</td>
                        </tr>
                        <tr>
                            <td>Content-Type</td>
                            <td>application/octet-stream</td>
                            <td>原始通知使用二进制流格式</td>
                        </tr>
                    </table>
                </li>
                <li>注意事项:
                    <ul>
                        <li>不需要外部NuGet包</li>
                        <li>使用纯HTTP请求实现</li>
                        <li>确保已配置正确的WNS凭据</li>
                        <li>服务总线命名空间和通知中心名称需要替换为实际值</li>
                    </ul>
                </li>
            </ul>
            
            <p><strong>参考文档：</strong> 
            <a href="https://docs.microsoft.com/en-us/azure/notification-hubs/notification-hubs-windows-store-dotnet-get-started-wns-push-notification" target="_blank">WNS通知文档</a> | 
            <a href="https://docs.microsoft.com/en-us/previous-versions/windows/apps/hh465435(v=win.10)" target="_blank">WNS原始通知</a></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const source = document.getElementById('source');
            const target = document.getElementById('target');
            const dropSegment1 = document.getElementById('drop-segment1');
            const dropSegment2 = document.getElementById('drop-segment2');
            const checkAnswerBtn = document.getElementById('check-answer');
            const answerSection = document.getElementById('answer-section');
            
            let draggedItem = null;
            
            // Drag start event
            source.addEventListener('dragstart', function(e) {
                if (e.target.classList.contains('drag-item')) {
                    draggedItem = e.target;
                    e.dataTransfer.setData('text/plain', e.target.dataset.id);
                    setTimeout(() => {
                        e.target.style.opacity = '0.4';
                    }, 0);
                }
            });
            
            // Drag end event
            source.addEventListener('dragend', function(e) {
                if (e.target.classList.contains('drag-item')) {
                    setTimeout(() => {
                        e.target.style.opacity = '1';
                        draggedItem = null;
                    }, 0);
                }
            });
            
            // Drag over event for drop targets
            [dropSegment1, dropSegment2].forEach(dropTarget => {
                dropTarget.addEventListener('dragover', function(e) {
                    e.preventDefault();
                });
                
                dropTarget.addEventListener('drop', function(e) {
                    e.preventDefault();
                    if (draggedItem) {
                        this.textContent = draggedItem.textContent;
                        this.style.backgroundColor = '#4CAF50';
                        this.style.color = 'white';
                        this.dataset.selectedCode = draggedItem.dataset.id;
                    }
                });
            });
            
            // Check answer button
            checkAnswerBtn.addEventListener('click', function() {
                // Check answers
                const segment1Answer = dropSegment1.dataset.selectedCode;
                const segment2Answer = dropSegment2.dataset.selectedCode;
                
                if (segment1Answer === 'windows') {
                    dropSegment1.style.backgroundColor = '#4CAF50';
                } else {
                    dropSegment1.style.backgroundColor = '#FF5722';
                }
                
                if (segment2Answer === 'application/octet-stream') {
                    dropSegment2.style.backgroundColor = '#4CAF50';
                } else {
                    dropSegment2.style.backgroundColor = '#FF5722';
                }
                
                answerSection.style.display = 'block';
                window.scrollTo({
                    top: answerSection.offsetTop,
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Container Registry Authentication Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            color: #333;
        }
        .authentication-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .authentication-table th, .authentication-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .authentication-table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .dropdown {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .button {
            background-color: #0078d4;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 15px;
        }
        .button:hover {
            background-color: #005a9e;
        }
        .answer {
            margin-top: 20px;
            padding: 15px;
            background-color: #e6f2ff;
            border-radius: 5px;
            display: none;
        }
        .correct-answer {
            color: green;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h2>QUESTION NO: 280 HOTSPOT</h2>
    <p>You develop a containerized application. You plan to deploy the application to a new Azure Container instance by using a third-party continuous integration and continuous delivery (CI/CD) utility.</p>
    <p>The deployment must be unattended and include all application assets. The third-party utility must only be able to push and pull images from the registry. The authentication must be managed by Azure Active Directory (Azure AD). The solution must use the principle of least privilege.</p>
    <p>You need to ensure that the third-party utility can access the registry.</p>
    <p>Which authentication options should you use? To answer, select the appropriate options in the answer area.</p>
    <p>NOTE: Each correct selection is worth one point.</p>

    <table class="authentication-table">
        <thead>
            <tr>
                <th>Authentication</th>
                <th>Option</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Registry authentication method</td>
                <td>
                    <select id="authMethod" class="dropdown">
                        <option value="">Select an option</option>
                        <option value="Service principal">Service principal</option>
                        <option value="Individual identity">Individual identity</option>
                        <option value="Repository-scoped access token">Repository-scoped access token</option>
                        <option value="Managed identity for Azure resources">Managed identity for Azure resources</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>RBAC role</td>
                <td>
                    <select id="rbacRole" class="dropdown">
                        <option value="">Select an option</option>
                        <option value="AcrPull">AcrPull</option>
                        <option value="Owner">Owner</option>
                        <option value="AcrPush">AcrPush</option>
                        <option value="Contributor">Contributor</option>
                    </select>
                </td>
            </tr>
        </tbody>
    </table>

    <button id="showAnswer" class="button">查看答案</button>

    <div id="answer" class="answer">
        <h3>正确答案:</h3>
        <p>Registry authentication method: <span class="correct-answer">Service principal</span></p>
        <p>RBAC role: <span class="correct-answer">AcrPush</span></p>
        
        <h3>说明:</h3>
        <p>根据题目要求和最小权限原则，正确的认证配置应为：</p>
        <ol>
            <li><strong>服务主体(Service principal)</strong>：这是最适合第三方CI/CD工具的无值守认证方式，可以通过Azure AD进行管理。</li>
            <li><strong>AcrPush角色</strong>：题目要求第三方工具需要能够推送和拉取镜像，AcrPush角色同时包含这两种权限（AcrPull权限包含在AcrPush中）。</li>
        </ol>
        <p>其他选项分析：</p>
        <ul>
            <li>个人身份(Individual identity)不适合自动化场景</li>
            <li>存储库作用域令牌(Repository-scoped access token)不符合Azure AD管理的要求</li>
            <li>托管标识(Managed identity)适用于Azure资源，不适用于第三方工具</li>
            <li>Owner和Contributor角色权限过大，不符合最小权限原则</li>
            <li>单独使用AcrPull角色无法满足推送镜像的需求</li>
        </ul>
    </div>

    <script>
        document.getElementById('showAnswer').addEventListener('click', function() {
            document.getElementById('answer').style.display = 'block';
            
            // Set the correct selections
            document.getElementById('authMethod').value = 'Service principal';
            document.getElementById('rbacRole').value = 'AcrPush';
        });
    </script>
</body>
</html>
